#!/bin/bash




touch /root/.aria2/aria2.session
chmod 0777 /root/.aria2/ -R

nohup filebrowser -r /  -p 9184 >> /dev/null 2>&1 & 
#nohup ./FolderMagic -aria "http://127.0.0.1:6800/jsonrpc" -auth root:$Aria2_secret -bind :9184 -root / -wd /webdav >> /dev/null 2>&1 & 

mkdir /.config/
mkdir /.config/rclone
touch /.config/rclone/rclone.conf

wget git.io/tracker.sh
chmod 0777 /tracker.sh
/bin/bash tracker.sh "/root/.aria2/aria2.conf"

# 创建配置文件目录
mkdir -p /root/.config/rclone
touch /root/.config/rclone/rclone.conf
cat >/root/.config/rclone/rclone.conf <<EOF
[fly]
type = onedrive
client_id = 334893a8-0d92-4180-9a20-c7509196ab8b
client_secret = pFh8Q~StMJEA2ahntXfUysJEuLnIC2-.3nO69cpH
token = {"access_token":"eyJ0eXAiOiJKV1QiLCJub25jZSI6InNSbUxGb2VKTkFmVE4zdDVmLWxnTlNZTDMtRF9lbnlDc3FMcTAzSmZrLWsiLCJhbGciOiJSUzI1NiIsIng1dCI6IjJaUXBKM1VwYmpBWVhZR2FYRUpsOGxWMFRPSSIsImtpZCI6IjJaUXBKM1VwYmpBWVhZR2FYRUpsOGxWMFRPSSJ9.eyJhdWQiOiIwMDAwMDAwMy0wMDAwLTAwMDAtYzAwMC0wMDAwMDAwMDAwMDAiLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC81M2ZkOTdhOC0wOWRmLTQwYjgtYjAwNC05YWU0YzcwNGQ2MTcvIiwiaWF0IjoxNjU4ODQwMDEyLCJuYmYiOjE2NTg4NDAwMTIsImV4cCI6MTY1ODg0NDY4MiwiYWNjdCI6MCwiYWNyIjoiMSIsImFpbyI6IkFWUUFxLzhUQUFBQXVlNWN1d0VXUmxyaitra2IvTVZBZXpBbXpZMGF2dnpuM05vVUtockpCblFzVXNwT3I4VjF2K0FRVE15NWtDTExyNGtBVXREazJsVk1iallhOS9ualJoZUJZTEJUeDVGL3ZSckFCaXdZOWJnPSIsImFtciI6WyJwd2QiLCJyc2EiLCJtZmEiXSwiYXBwX2Rpc3BsYXluYW1lIjoiYXJpYTItb25lZHJpdmUiLCJhcHBpZCI6IjMzNDg5M2E4LTBkOTItNDE4MC05YTIwLWM3NTA5MTk2YWI4YiIsImFwcGlkYWNyIjoiMSIsImRldmljZWlkIjoiOTJhMGZhNjMtYzA1NS00MTUwLTg4NDgtOWU4NGZiYzhmMDRkIiwiZmFtaWx5X25hbWUiOiJTdGFyYnVyIiwiZ2l2ZW5fbmFtZSI6IkFsbGVuIiwiaWR0eXAiOiJ1c2VyIiwiaXBhZGRyIjoiOC4zOC4xNzIuMzMiLCJuYW1lIjoiU3RhcmJ1ciBBbGxlbiIsIm9pZCI6ImU4MjYwZDE4LTQ1MDgtNDQwYS1hYTU1LWYyY2RlYWE3NzU4MSIsInBsYXRmIjoiMyIsInB1aWQiOiIxMDAzMjAwMjAwNENGNTlEIiwicmgiOiIwLkFWVUFxSmY5VTk4SnVFQ3dCSnJreHdUV0Z3TUFBQUFBQUFBQXdBQUFBQUFBQUFDSUFLNC4iLCJzY3AiOiJGaWxlcy5SZWFkIEZpbGVzLlJlYWQuQWxsIEZpbGVzLlJlYWRXcml0ZSBGaWxlcy5SZWFkV3JpdGUuQWxsIFNpdGVzLlJlYWQuQWxsIHByb2ZpbGUgb3BlbmlkIGVtYWlsIiwic2lnbmluX3N0YXRlIjpbImttc2kiXSwic3ViIjoiSWxoU29Oa3hhcVlzX0VHMzNlREZFUGlzTGQyWWRWQ1pmbWRrY09QaWVpSSIsInRlbmFudF9yZWdpb25fc2NvcGUiOiJBUyIsInRpZCI6IjUzZmQ5N2E4LTA5ZGYtNDBiOC1iMDA0LTlhZTRjNzA0ZDYxNyIsInVuaXF1ZV9uYW1lIjoiQWxsZW5AcmVhZGVyaW5nLm9ubWljcm9zb2Z0LmNvbSIsInVwbiI6IkFsbGVuQHJlYWRlcmluZy5vbm1pY3Jvc29mdC5jb20iLCJ1dGkiOiI5clZUaTIwNEUwU1JxNGRZOTNybkFRIiwidmVyIjoiMS4wIiwid2lkcyI6WyI2MmU5MDM5NC02OWY1LTQyMzctOTE5MC0wMTIxNzcxNDVlMTAiLCJiNzlmYmY0ZC0zZWY5LTQ2ODktODE0My03NmIxOTRlODU1MDkiXSwieG1zX3N0Ijp7InN1YiI6InB1YlFVenlEQmc2OVN4OUVJbW5URUpORGdWNzZtTnp3RXdVTWdCaDl4WlEifSwieG1zX3RjZHQiOjE2NTQwMTMxNDh9.kODa_ahyZXpk-2QavweCI5DOAa3go10_-b7UmXz23ECBhq3qsf7iZP2hGcv5hY2Ix0_2EkiVD5RHxxAoIT1x8gEEkh8dgF_IUkgfTYZLxKH7J0wCOHEd60ejwZAb2Mn1hXzrxJZ79UNpQj4i2QvWx4VjjpmhaQrS7tPOcsjsCQGDHV1GP0hYQchSjyGxsAxgnVoZvW8CrGaeFc0dQuqFIZuFOVUrXpcbkwDBC8EUs81fZjWlfzZQMc3IG3l9fRG4gwtYnuHsck1HlyWgLzXOoCDajrPYkiPZr9YT5Hri096vS3SaIfmqjiZh7btqcXiOgJpvAFJ6yCQsEdztrHkjRw","token_type":"Bearer","refresh_token":"0.AVUAqJf9U98JuECwBJrkxwTWF6iTSDOSDYBBmiDHUJGWq4uIAK4.AgABAAEAAAD--DLA3VO7QrddgJg7WevrAgDs_wQA9P-1mseVhQrH8Fea7lNVtuJz9hIv3nxuog9GOjq2M5YWYEWs01tT8XWKuSFy5OcUed1nW6gGriaDsQKSzqHfj0ic_F_7kHKj_q12GPg1CMiHmsq7rO63_PGSVQMNtvGNST2a91I9_IOpEZ7q39u6RX1Jxt6soYsP9XVC-fX-fPG-JwTaaLaqtA1FstmbmSiQjhZRnf_dfhuGpobIbvpupBuvkXDMtEDRjRa76gapl8EV0MGJrqV9HE9_-c9_7b79bLK4efFQba3Urwv-DzzACABj_SsK2SqsR80nfHk2EOlQP3MkDcLwPvPzziXwL1aF40eJiSDHiHlFq5KteEIOEWVnmfFiUAjyZnXRVth2NIcLwF2ub-8nS-bpPSPPJSd94DbpTVVnXJlQ452d44GJC9ZeX9cV2zi7q7lyLyOgzywtT8W1omK341es6A8QgFSatqNWP1m6FwplpLksZVevY_gQZqdT1nn6UMXXVyUrQZYIzjAn6Vni4WbFqHYpiWD0NSrs13f-u4W-7JdyF4coTp0cVK1-ct9fv8EHwGhjHy-key0PNyw0Fck6dxS7o7MRIT1hjqHnd0hG1UQlLchJr5Vtis4NFw1d_sdtsVktcGzFDMAV_H3A2KqBB_lrWSmcXiLVDTf5TM9gCIeAnx4teuHnTviFx_lOU71sqSoY_rN0vzLHitWBDSaNCKTnH_TATh2Wyci1HlMqSxC2DDKakbpYDqSTzmEJrkdLey-BAcPrSTlI05vUXKWMwSKTBwL30J8WjfMQipLDMKQFIrbBuKRuaLayyKLP8YeqxFW7l959lmyxo_Jr7lFUpRGfZuUKCg9Z8_CMa9kc-c9FDBlxFpr1b_GgHZqHrHip2mzjZ5UA8Vz_5npi6AivlWddJLC1DotcQ_E8cs-Hz5WRqYqdV-mw4sw7vmLMqp0S9UhkBIILGAJ5nX7JC_iCcHSz-2Wb2g7V","expiry":"2022-07-26T22:11:21.546298887+08:00"}
drive_id = b!YouiVjyc6UmGH2-H98ldVGFqAuO9mCpEu-l04RP_vYOoD4S_WNmhQppxNQBot2_o
drive_type = business
EOF

rm -rf /bot
git clone https://github.com/666wcy/ARPT-Bot.git
mkdir /bot/
mv /ARPT-Bot/bot/* /bot/

rm /etc/nginx/nginx.conf
cp /ARPT-Bot/root/nginx.conf /etc/nginx/

rm -rf /ARPT-Bot

#python3 /bot/nginx.py
nginx -c /etc/nginx/nginx.conf
nginx -s reload

nohup aria2c --conf-path=/root/.aria2/aria2.conf --rpc-listen-port=8080 --rpc-secret=$Aria2_secret &
nohup rclone rcd --rc-addr=127.0.0.1:5572 --rc-user=root --rc-pass=$Aria2_secret --rc-allow-origin="https://elonh.github.io" &
#nohup python3 /bot/web.py &

python3 /bot/main.py
